insert into TASK(CREATION,EXPIRE_TIME,PROVIDER_ID,TYPE,FILE_ID,FILE_HASH,FILE_SIZE,BLOCK_HASH,BLOCK_SIZE,OPPOSITE_ID) select now(), now()+(INTERVAL '1day'), 'gO25LJSmGAWaX6I3wgQt96EHnSk=','REPLICATE',d.FILE_ID,f.HASH,f.SIZE,d.HASH,d.SIZE,d.PRO_ID from  (select m.FILE_ID as FILE_ID,m.HASH as HASH,m.SIZE as SIZE,array_agg(b.PROVIDER_ID) as PRO_ID from BLOCK b,PROOF_METADATA m where b.FILE_ID = m.FILE_ID and b.HASH=m.HASH group by m.FILE_ID,m.HASH,m.SIZE) d,FILE f where f.ID=d.FILE_ID;

